<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NweOo SMS</title>
    <link rel="stylesheet" href="bootstrap.min.css" />
    <script src="axios.min.js"></script>
    <script src="vue.min.js"></script>
    <script src="/vue-router.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
  </head>

  <body>
    <div class="container mt-2">
      <main>
        <section>
          <h2>Users</h2>
          <table class="table table-hover">
            <thead>
              <tr>
                <th>Headline Title</th>
                <th>Recieved</th>
                <th colspan="3">Quota</th>
                <th>Expired On</th>
              </tr>
            </thead>
            <tbody>
              <tr v-for="user in users" :key="user.id">
                <td>{{ user.id }}</td>
                <td>{{ user.total_count }}</td>
                <td>{{ user.session.read_count }}/6</td>
                <td>{{ user.session.total_action }}/21</td>
                <td>{{ user.session.character_count }}/10001</td>
                <td>{{ new Date(user.session.expired).toLocaleString() }}</td>
              </tr>
            </tbody>
          </table>
          <ul class="pagination">
            <li class="page-item disabled">
              <a class="page-link" href="#" tabindex="-1" aria-disabled="true"
                >Previous</a
              >
            </li>
            <li class="page-item active">
              <a class="page-link" href="#">1</a>
            </li>
            <li class="page-item" aria-current="page">
              <a class="page-link" href="#">2</a>
            </li>
            <li class="page-item">
              <a class="page-link" href="#">Next</a>
            </li>
          </ul>
        </section>
        <div class="mt-4"></div>
        <section>
          <h2>Articles</h2>
          <table class="table table-hover">
            <thead>
              <tr>
                <th>Headline Title</th>
                <th>Count</th>
                <th>Published</th>
                <th>Source</th>
              </tr>
            </thead>
            <tbody>
              <tr v-for="article in articles" :key="article.id">
                <td>{{ article.title }}</td>
                <td>{{ article.content.length }}</td>
                <td>{{ new Date(article.datetime).toLocaleString() }}</td>
                <td>{{ article.source }}</td>
              </tr>
            </tbody>
          </table>
        </section>
      </main>
    </div>

    <script>
      const socket = io();
      const app = new Vue({
        el: "main",
        data: {
          users: [],
          articles: [],
          pages: 0,
        },
        beforeMount() {
          axios("/api/articles").then(({ data }) => {
            this.articles = data.reverse();
          });

          axios("/api/users").then(({ data: { data, size } }) => {
            this.pages = Math.floor(size / 10);
            this.users = data.reverse();
          });
        },
      });
    </script>
  </body>
</html>
